<!DOCTYPE html>
<html lang="en" dir="">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Editando Caso</title>
    <link href="https://fonts.googleapis.com/css?family=Nunito:300,400,400i,600,700,800,900" rel="stylesheet" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="/dist-assets/css/themes/lite-purple.min.css" rel="stylesheet" />
    <link href="/dist-assets/css/plugins/perfect-scrollbar.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

</head>

<body class="text-left">
    <div class="app-admin-wrap layout-horizontal-bar">
        <div class="main-header">
            <div class="logo"><img src="/dist-assets/images/logo.png" alt="" /></div>
            <div class="menu-toggle">
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div class="d-flex align-items-center">
               
            </div>
            <div style="margin: auto">
                
            </div>
            <div class="header-part-right">  
                <h4 class="mt-3 mr-3 " id="userNameDisplay"></h4> 
                <a class="link-icon mr-1" href="/index.html" style="font-size:xx-large; color: brown;"><i class="fa-solid fa-power-off"></i></a>
            </div>
        </div>
        
        <!-- header top menu end-->
        <div class="horizontal-bar-wrap">
            <div class="header-topnav">
                <div class="container-fluid bar-views">
                    <div class="topnav rtl-ps-none" id="" data-perfect-scrollbar="" data-suppress-scroll-x="true">
                        <ul class="menu float-left">
                            <li class="views" id="nuevoCaso">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Nuevo caso</label>
                                        <a href="nuevoCaso.html"><i class="nav-icon mr-2 i-Library text-white"></i> <span class="text-white">Nuevo caso</span> </a>
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="casosPendientes">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Mesa de Entrada</label><a href="casosPendientes.html"><i class="nav-icon i-File-Horizontal-Text mr-2 text-white"></i> <span class="text-white">Mesa de Entrada</span></a>
                                       
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="casosGestion">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Casos en Gestión</label>
                                        <a href="casosEnGestion.html"><i class="nav-icon mr-2 i-Receipt text-white"></i><span class="text-white">Casos en Gestión</span></a>
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="baseUnica">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Base única</label>
                                        <a href="baseUnica.html"><i class="nav-icon i-File-Horizontal-Text mr-2 text-white"></i> <span class="text-white">Base única</span></a>
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="estadisticas">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Estadísticas</label>
                                        <a href="estadisticas.html"><i class="nav-icon mr-2 i-Bar-Chart-5 text-white"></i> <span class="text-white">Estadísticas</span></a>
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="facturacion">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Facturación</label>
                                        <a href="facturacion.html"><i class="nav-icon mr-2 i-Windows-2 text-white"></i><span class="text-white">Facturación</span></a>
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="casosPas">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Mis Casos</label>
                                        <a href="casosPas.html"><i class="nav-icon i-File-Horizontal-Text mr-2 text-white"></i> <span class="text-white">Mis Casos</span></a>
                                    </div>
                                </div>
                            </li>
                            <li class="views" id="novedades">
                                <div>
                                    <div>
                                        <label class="toggle" for="drop-2">Información Útil</label>
                                        <a href="novedades.html"><i class="nav-icon i-File-Horizontal-Text mr-2 text-white"></i> <span class="text-white">Novedades</span></a>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- =============== Horizontal bar End ================-->
        <div class="main-content-wrap d-flex flex-column">
            <!-- ============ Body content start ============= -->
            <div class="main-content">
                <div class="breadcrumb">
                </div>
                <div class="separator-breadcrumb border-top"></div>
                <div class="row mb-4">
                    <!-- <div class="col-md-12 d-flex justify-content-end"> 
                        <button id="authorize_button" class="btn btn-secondary" onclick="handleAuthClick()">A</button>
                    </div> -->
                </div>
                <div class="inbox-main-sidebar-container" data-sidebar-container="main">
                    <div class="inbox-main-content" data-sidebar-content="main">
                        <!-- SECONDARY SIDEBAR CONTAINER-->
                        <div class="inbox-secondary-sidebar-container box-shadow-1" data-sidebar-container="secondary">
                            <div data-sidebar-content="secondary">
                                <div class="inbox-secondary-sidebar-content position-relative" style="min-height: 500px">
                                    <div class="inbox-topbar box-shadow-1 perfect-scrollbar rtl-ps-none pl-3" data-suppress-scroll-y="true">
                                        <a class="link-icon d-md-none" data-sidebar-toggle="main"><i class="icon-regular i-Arrow-Turn-Left"></i></a><a class="link-icon mr-3 d-md-none" data-sidebar-toggle="secondary"><i class="icon-regular mr-1 i-Left-3"></i> Inbox</a>
                                        <div class="d-flex">
                                           
                                            <a class="link-icon mr-3" id="desistido" onclick="desistido(event)" style="cursor: pointer;"><i class="icon-regular i-Mail-Remove-x"></i> Desistido</a><a class="link-icon mr-3" id="mediacion" onclick="mediacion(event)" style="cursor: pointer;"><i class="icon-regular i-Mail-Password"></i> Mediación</a><a class="link-icon mr-3" id="legales" onclick="legales(event)" style="cursor: pointer;"><i class="icon-regular i-Mail-Password"></i> Legales</a><a class="link-icon mr-3" id="saveChanges" onclick="uploadFiles(event)" style="cursor: pointer;"><i class="icon-regular i-Mail-Password"></i>Actualizar</a><a class="link-icon mr-3" id="derivado" onclick="derivarAEjecutivo(event)" style="cursor: pointer;"><i class="icon-regular i-Mail-Password"></i> Derivar a ejecutivo</a><a class="link-icon mr-3" id='sendWhatsApp' style="cursor: pointer;"><i class="icon-regular i-Mail-Send"></i> Notificar a cliente</a> </div>

                                    </div>
                                    <div class="row">
                                    <div class="col-md-6">
                                    <div class="form-floating">
                                        <textarea class="form-control" placeholder="Escribir..." id="actualizacion" style="height: 100px"></textarea>
                                      </div>
                                   <div>
                                    <div class="form-check form-check-inline mt-5">
                                        <label class="checkbox checkbox-outline-info">
                                          
                                        </label>
                                      </div>
                                     
                                   </div>
                                   
                                   <div class="input-group mb-3" id="1" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">DNI (frente)</label>
                                    <input type="file" class="form-control" id="adjDniFrente">
                                  </div>
                                  <div class="input-group mb-3" id="2" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">DNI (dorso)</label>
                                    <input type="file" class="form-control" id="adjDniDorso">
                                  </div>
                                  <div class="input-group mb-3" id="3" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Registro (frente)</label>
                                    <input type="file" class="form-control" id="adjRegistroFrente">
                                  </div>
                                  <div class="input-group mb-3" id="4" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Registro (dorso)</label>
                                    <input type="file" class="form-control" id="adjRegistroDorso">
                                  </div>
                                  <div class="input-group mb-3" id="5" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Cédula Verde (Frente)</label>
                                    <input type="file" class="form-control" id="adjCedulaVerdeFrente">
                                  </div>
                                  <div class="input-group mb-3" id="6" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Cédula Verde (Dorso)</label>
                                    <input type="file" class="form-control" id="adjCedulaVerdeDorso">
                                  </div>
                                  <div class="input-group mb-3" id="7" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Denuncia Administrativa</label>
                                    <input type="file" class="form-control" id="adjDenunciaAdm">
                                  </div>
                                  <div class="input-group mb-3" id="8" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Certificado de cobertura</label>
                                    <input type="file" class="form-control" id="adjCertCobertura">
                                  </div>
                                  <div class="input-group mb-3" id="9" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Foto Siniestro</label>
                                    <input type="file" class="form-control" id="adjFotoSiniestro">
                                  </div>
                                  <div class="input-group mb-3" id="10" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Presupuesto</label>
                                    <input type="file" class="form-control" id="adjPresupuesto">
                                  </div>
                                  <div class="input-group mb-3" id="11" style="visibility:hidden;">
                                    <label class="input-group-text" for="inputGroupFile01">Contrato Social</label>
                                    <input type="file" class="form-control" id="adjContratoSoc">
                                  </div>

                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <textarea class="form-control" placeholder="Historial..." id="historial" style="height: 100px" disabled></textarea>
                                  </div>
                               <div>
                               </div>
                             <div class="">
                                <div class="input-group mt-2 mb-3">
                                    <div class="input-group-prepend "><span class="input-group-text" >Teléfono</span></div>
                                    <input class="form-control" id="telefono" type="text" aria-describedby="basic-addon3" />
                                </div>
                                <div class="input-group mt-2 mb-3">
                                    <div class="input-group-prepend "><span class="input-group-text" >Mail</span></div>
                                    <input class="form-control" id="email" type="text" aria-describedby="basic-addon3" />
                                </div>
                                <div class="input-group mt-2 mb-3">
                                    <div class="input-group-prepend "><span class="input-group-text" >Observación</span></div>
                                    <input class="form-control" id="obs" type="text" aria-describedby="basic-addon3" />
                                </div>
                                <div class="input-group mt-2 mb-3 mt-4">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Estado</span>
                                    </div>
                                    <!-- Convierte el input en un select -->
                                    <select class="form-control" id="estado"></select>
                                </div>
                             </div>

                        </div>
                            </div>
                         </div>
                        </div>
                    </div>
                            </div>
                            <!-- Secondary Inbox sidebar-->
                            <div class="inbox-secondary-sidebar perfect-scrollbar rtl-ps-none" data-sidebar="secondary"><i class="sidebar-close i-Close" data-sidebar-toggle="secondary"></i>
                                <div class="input-group mt-2 mb-3 mt-4">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">PAS</span>
                                    </div>
                                    <!-- Convierte el input en un select -->
                                    <select class="form-control" id="pasDropdown"></select>
                                </div>
                                <div class="input-group mt-2 mb-3">
                                    <div class="input-group-prepend "><span class="input-group-text" >Cliente</span></div>
                                    <input class="form-control" id="cliente" type="text" aria-describedby="basic-addon3" />
                                </div>
                                <div class="input-group mt-2 mb-3">
                                    <div class="input-group-prepend "><span class="input-group-text" >Fecha de ingreso</span></div>
                                    <input class="form-control" id="ingreso" type="text" aria-describedby="basic-addon3" />
                                </div>
                                <div class="input-group mt-2 mb-3">
                                    <div class="input-group-prepend "><span class="input-group-text" >Dominio</span></div>
                                    <input class="form-control" id="dominio" type="text" aria-describedby="basic-addon3" />
                                </div>
                                <div class="input-group mt-2 mb-3 mt-4">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">CIA a Reclamar</span>
                                    </div>
                                    <!-- Convierte el input en un select -->
                                    <select class="form-control" id="ciaReclamar"></select>
                                </div>
                                <div class="input-group mt-2 mb-3 mt-4">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">Tipo de Reclamo</span>
                                    </div>
                                    <!-- Convierte el input en un select -->
                                    <select class="form-control" id="tipoReclamo"></select>
                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- MAIN INBOX SIDEBAR-->
                </div>
  
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        const alertPlaceholder = document.getElementById('liveAlertPlaceholder')
const appendAlert = (message, type) => {
  const wrapper = document.createElement('div')
  wrapper.innerHTML = [
    `<div class="alert alert-${type} alert-dismissible" role="alert">`,
    `   <div>${message}</div>`,  
    '</div>'
  ].join('')

  alertPlaceholder.append(wrapper)
}

// const alertTrigger = document.getElementById('liveAlertBtn')
// if (alertTrigger) {
//   alertTrigger.addEventListener('click', () => {
//     appendAlert('Información enviada exitosamente', 'success')
//   })
// }
        document.addEventListener('DOMContentLoaded', () => {
            const userData = JSON.parse(localStorage.getItem('userData'));
        
            if (userData) {
                const permission = userData.permission; // Asumimos que este es un string con el permiso del usuario
                const name = userData.name;
                document.getElementById('userNameDisplay').innerText = `${userData.name}`;
                // Ocultar todas las pestañas inicialmente
                document.querySelectorAll('.views').forEach(view => {
                    view.style.display = 'none'; // Ocultar todas las pestañas
                });
        
                // Mostrar pestañas basadas en permisos
                if (permission === 'super usuario') {
                    document.getElementById('nuevoCaso').style.display = 'block';
                    document.getElementById('casosPendientes').style.display = 'block';
                    document.getElementById('casosGestion').style.display = 'block';
                    document.getElementById('baseUnica').style.display = 'block';
                    document.getElementById('estadisticas').style.display = 'block';
                    document.getElementById('facturacion').style.display = 'block';
                    document.getElementById('casosPas').style.display = 'block';
                    document.getElementById('novedades').style.display = 'block';
                } else if (permission === 'ejecutivo') {
                    document.getElementById('nuevoCaso').style.display = 'block';
                    document.getElementById('casosGestion').style.display = 'block';
                    document.getElementById('baseUnica').style.display = 'block';
                    document.getElementById('estadisticas').style.display = 'block';
                } else if (permission === 'mesa de entrada') {
                    document.getElementById('nuevoCaso').style.display = 'block';
                    document.getElementById('casosPendientes').style.display = 'block';
                } else if (permission === 'mediacion') {
                    document.getElementById('nuevoCaso').style.display = 'block';
                    document.getElementById('casosGestion').style.display = 'block';
                    document.getElementById('baseUnica').style.display = 'block';
                    document.getElementById('estadisticas').style.display = 'block';
                }else if (permission === 'jefe de operaciones') {
                    document.getElementById('nuevoCaso').style.display = 'block';
                    document.getElementById('casosGestion').style.display = 'block';
                    document.getElementById('baseUnica').style.display = 'block';
                    document.getElementById('estadisticas').style.display = 'block';

                }else if (permission === 'PAS') {
                    document.getElementById('casosPas').style.display = 'block';
                    document.getElementById('novedades').style.display = 'block';

                }else if (permission === 'LEGALES') {
                    document.getElementById('casosGestion').style.display = 'block';
                    document.getElementById('baseUnica').style.display = 'block';
                }else if (permission === 'FACTURACION') {
                    document.getElementById('facturacion').style.display = 'block';
                    document.getElementById('estadisticas').style.display = 'block';
                }
            } else {
                // Si no hay información de usuario, redirigir a login
                window.location.href = 'index.html';
            }
        });
        const CLIENT_ID = '607561137784-rq84r06gop7p4hjo1nnv0q5re4fl2nff.apps.googleusercontent.com';
const API_KEY = 'AIzaSyBLuMXUjJmU3XLfErAIH-iI4pXzmSnl-0E';
const DISCOVERY_DOCS = [
    'https://www.googleapis.com/discovery/v1/apis/drive/v3/rest',
    'https://www.googleapis.com/discovery/v1/apis/sheets/v4/rest'
];
const SCOPES = 'https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/spreadsheets';

let tokenClient;
let gapiInited = false;
let gisInited = false;

function gapiLoaded() {
    gapi.load('client', initializeGapiClient);
}

async function initializeGapiClient() {
    try {
        await gapi.client.init({
            apiKey: API_KEY,
            discoveryDocs: DISCOVERY_DOCS,
        });
        gapiInited = true;

        // Intentar autenticación silenciosa
        attemptSilentAuth();
    } catch (error) {
        console.error('Error al inicializar GAPI:', error);
    }
}

function gisLoaded() {
    tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: CLIENT_ID,
        scope: SCOPES,
        callback: (resp) => {
            if (resp.error) {
                console.error('Error durante la autenticación:', resp.error);
            } else {
                const token = gapi.client.getToken();
                console.log('Token recibido:', token);
                storeToken(token);
            }
        },
    });
    gisInited = true;
}

function attemptSilentAuth() {
    const token = retrieveToken();
    if (token && token.access_token) {
        console.log('Token válido encontrado:', token.access_token);
        gapi.client.setToken(token);
    } else {
        console.warn('No hay token válido. Intentando autenticación silenciosa.');
        tokenClient.requestAccessToken({ prompt: '' });
    }
}

function handleAuthClick() {
    tokenClient.callback = (resp) => {
        if (resp.error) {
            console.error('Error durante la autenticación:', resp.error);
        } else {
            const token = gapi.client.getToken();
            console.log('Token recibido tras autenticación manual:', token);
            storeToken(token);
        }
    };

    const token = gapi.client.getToken();
    if (!token) {
        tokenClient.requestAccessToken({ prompt: 'consent' });
    } else {
        tokenClient.requestAccessToken({ prompt: '' });
    }
}

function handleSignoutClick() {
    const token = gapi.client.getToken();
    if (token) {
        google.accounts.oauth2.revoke(token.access_token, () => {
            console.log('Sesión cerrada y token revocado.');
            gapi.client.setToken('');
            clearStoredToken();
        });
    }
}
function storeToken(token) {
    // Si el token es un objeto, almacena solo el access_token como string
    const accessToken = typeof token === 'object' ? token.access_token : token;
    localStorage.setItem('google_access_token', accessToken);
}

function retrieveToken() {
    // Recupera el token como string y lo devuelve en el formato esperado
    const accessToken = localStorage.getItem('google_access_token');
    if (!accessToken) {
        return null;
    }
    return { access_token: accessToken };
}

function clearStoredToken() {
    localStorage.removeItem('google_access_token');
}

const spreadsheetId0 = '1gzp1hLfZaZMQarKdxPnvtHeyTioqhd3vatL-UmFnlUI';
const spreadsheetId2 = '1FdJtx_Dr8dgvC-9HWfckT8qzHm8BikoSbV9EORXSEb8';
const apiKey2 = 'AIzaSyBLuMXUjJmU3XLfErAIH-iI4pXzmSnl-0E'; //  clave de API
const range0 = 'sheet1'; // 
const range2 = 'Hoja 1'; // 
const range3 = 'Hoja 2'; // 
const range4 = 'Hoja 3'; // 

// URL de la API de Google Sheets
const url0 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId0}/values/${range0}?key=${apiKey2}`;
const url2 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId2}/values/${range2}?key=${apiKey2}`;
const url3 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId2}/values/${range3}?key=${apiKey2}`;
const url4 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId2}/values/${range4}?key=${apiKey2}`;

document.addEventListener('DOMContentLoaded', function() {
    // Inicializa Select2 en el elemento select
    $('#pasDropdown').select2({
        placeholder: 'Seleccione un nombre',
        allowClear: true,
        width: '100%'
    });
    $('#ciaReclamar').select2({
        placeholder: 'Seleccione un nombre',
        allowClear: true,
        width: '100%'
    });
    $('#tipoReclamo').select2({
        placeholder: 'Seleccione un nombre',
        allowClear: true,
        width: '90%'
    });
    $('#estado').select2({
        placeholder: 'Seleccione un nombre',
        
        width: '100%'
    });

    // Realiza la solicitud fetch para obtener datos dinámicos
    fetch(url0)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const rows = data.values;
            console.log(rows);

            // Extrae los nombres de la tercera columna (índice [2]), excluyendo la primera fila (cabeceras)
            const selectedRows = rows.slice(1).map(row => row[2]);
            
            // Prepara la lista dinámica en el formato que Select2 espera (id y text)
            const listaDinamica = selectedRows.map((nombre, index) => ({
                id: nombre,
                text: nombre
            }));

            console.log('Lista Dinámica:', listaDinamica);

            // Cargar la lista dinámica en el dropdown
            $('#pasDropdown').select2({
                data: listaDinamica
            });
        })
        .catch(error => console.error('Error al cargar datos', error));
        
       fetch(url2)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const rows = data.values;
            console.log(rows);

            // Extrae los nombres de la tercera columna (índice [2]), excluyendo la primera fila (cabeceras)
            const selectedRows = rows.slice(1).map(row => row[0]);
            
            // Prepara la lista dinámica en el formato que Select2 espera (id y text)
            const listaDinamica2 = selectedRows.map((nombre, index) => ({
                id: nombre,
                text: nombre
            }));

            console.log('Lista Dinámica:', listaDinamica2);

            // Cargar la lista dinámica en el dropdown
            $('#ciaReclamar').select2({
                data: listaDinamica2
            });
        })
        .catch(error => console.error('Error al cargar datos', error));
        fetch(url3)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const rows = data.values;
            console.log(rows);

            // Extrae los nombres de la tercera columna (índice [2]), excluyendo la primera fila (cabeceras)
            const selectedRows = rows.slice(1).map(row => row[0]);
            
            // Prepara la lista dinámica en el formato que Select2 espera (id y text)
            const listaDinamica3 = selectedRows.map((nombre, index) => ({
                id: nombre,
                text: nombre
            }));

            console.log('Lista Dinámica:', listaDinamica3);

            // Cargar la lista dinámica en el dropdown
            $('#estado').select2({
                data: listaDinamica3
            });
        })
        .catch(error => console.error('Error al cargar datos', error));
        fetch(url4)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            const rows = data.values;
            console.log(rows);

            // Extrae los nombres de la tercera columna (índice [2]), excluyendo la primera fila (cabeceras)
            const selectedRows = rows.slice(1).map(row => row[0]);
            
            // Prepara la lista dinámica en el formato que Select2 espera (id y text)
            const listaDinamica3 = selectedRows.map((nombre, index) => ({
                id: nombre,
                text: nombre
            }));

            console.log('Lista Dinámica:', listaDinamica3);

            // Cargar la lista dinámica en el dropdown
            $('#tipoReclamo').select2({
                data: listaDinamica3
            });
        })
        .catch(error => console.error('Error al cargar datos', error));

});
        </script>
    <!-- ============ Search UI End ============= -->
    <script src="/dist-assets/js/plugins/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="/dist-assets/js/plugins/bootstrap.bundle.min.js"></script>
    <script src="/dist-assets/js/plugins/perfect-scrollbar.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
    <script src="/dist-assets/js/scripts/script.min.js"></script>
    <script src="/dist-assets/js/scripts/sidebar-horizontal.script.js"></script>
    <script src="/dist-assets/js/scripts/sidebar.script.min.js"></script>
    <script src="/dist-assets/js/ingresos.js"></script>

</body>

</html>